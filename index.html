<!DOCTYPE html>
<html lang="en">
<head>
    <title>svg viewer</title>
    <script type="text/javascript" src="jquery.min.js"></script>
    <script type="text/javascript" src="jquery-svgpan.min.js"></script>
    <style type="text/css">
        #control { text-align: center; position: absolute; padding: 20px;
            opacity: 0.5; color: #fff; font-family: Arial;
            font-size: 150%; font-weight: bold; background-color: #000; }
        #info { text-align: center; position: absolute; padding: 10px 0;
            opacity: 0.5; color: #000; font-family: Arial;
            font-size: 150%; font-weight: bold; }
        #dropArea { border: 5px dashed #ccc; text-align: center; z-index: -1;
            position: absolute; color: #ccc; font-family: Arial;
            font-size: 300%; font-weight: bold; }
        #dropArea.hover { border: 5px dashed #333; color: #333; }
    </style>
</head>
<body>
    <div id="control">
        <input id="lock-zoom" type="checkbox" checked="checked">
        <label for="lock-zoom">lock zoom</label>
    </div>
    <div id="info"></div>
    <div id="dropArea">Drop file here</div>
    <script type="text/javascript">

        var curr_index = -1;
        var viewed_svgs = [];
        var viewed_names = [];
        var $dropArea = $('#dropArea');

        draw_svg = function (doc, name, lock_zoom) {
            var matrix_s = ''
            if (lock_zoom) {
                matrix_s = $('#viewport').attr("transform");
            }
            else {
                $('#dropArea').html(doc);
                var doc_width = $(dropArea).width();
                var doc_height = $(dropArea).height();
                var svg_width = parseInt($('svg').attr('width'));
                var svg_height = parseInt($('svg').attr('height'));
                var scale = Math.min(doc_width/svg_width,
                    doc_height/svg_height);
                var top = (doc_height - svg_height * scale) * .5;
                var left = (doc_width - svg_width * scale) * .5;
                matrix_s = 'translate('+left+','+top+')'
                         + ' scale('+scale+','+scale+')';
            }
            $('#info').html(name);
            $('#info').css({"background-color": "#ddd"});
            doc = doc.replace(/<svg.*?>/g,
                '<svg xmlns="http://www.w3.org/2000/svg" ' +
                'version="1.1"><g id="viewport">');
            doc = doc.replace(/<\/svg>/g, '</g></svg>');
            $('#dropArea').html(doc);
            $('#viewport').attr("transform", matrix_s);
            $('svg').svgPan('viewport', true, true, false, .5);
        };

        dropArea.ondragover = function () {
            this.className = 'hover';
            return false;
        };
        dropArea.ondragend = function () {
            this.className = '';
            return false;
        };
        dropArea.ondrop = function (e) {
            this.className = '';
            e.preventDefault();

            var is_first = curr_index < 0;
            var files = e.dataTransfer.files;
            for (var i = 0, file; file = files[i]; i++) {
                if (!file.type.match('image/svg.*')) {
                    continue;
                }
                var reader = new FileReader();
                reader.onload = (function(theFile) {
                    return function(e) {
                        doc = e.target.result;
                        if (doc != null && doc != '') {
                            var lock_zoom = (!is_first
                                && $("#lock-zoom").prop("checked"));
                            draw_svg(doc, theFile.name, lock_zoom);
                            viewed_svgs.push(doc);
                            viewed_names.push(theFile.name);
                            curr_index++;
                        }
                    };
                })(file);
                reader.readAsText(file);
            }
            return false;
        };

        $(document).keydown(function (e) {
            var need_redraw = false;
            switch (e.which) {
                case 37: // left
                if (curr_index > 0) {
                    curr_index--;
                    need_redraw = true;
                }
                break;

                case 39: // right
                if (curr_index < viewed_names.length - 1) {
                    curr_index++;
                    need_redraw = true;
                }
                break;

                default:
                break;
            }
            if (need_redraw) {
                e.preventDefault();
                var curr_svg = viewed_svgs[curr_index];
                var curr_name = viewed_names[curr_index];
                var lock_zoom = $("#lock-zoom").prop("checked");
                draw_svg(curr_svg, curr_name, lock_zoom);
            }
            return !need_redraw;
        });

        applyLayout = function() {
            $('#dropArea').width($(window).width() - 50);
            $('#dropArea').height($(window).height() - 50);
            $('#dropArea').css({"top": 16 + "px", "left": 16 + "px"});
            $('#info').width($('#dropArea').width() - 30);
            $('#info').css({"top": 36 + "px", "left": 36 + "px"});
            $('#control').css({"top": $('#dropArea').height()
                - $('#control').height() - 30 + "px", "left": 36 + "px"});
        }
        $(window).resize(applyLayout);
        $(document).ready(function() {
            applyLayout();
        });
    </script>
</body>
</html>